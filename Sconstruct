import sys

libs = [
    'sfml-graphics',
    'sfml-system',
    'sfml-audio',
    'sfml-window',
    'luajit',
    'm',
    'dl'
]
cflags = [
    '-std=c++17',
    '-fdiagnostics-color=always'
]
lflags = [
    '-pagezero_size', '10000',
    '-image_base', '100000000'
]

if sys.platform != 'darwin':
    libs.append('GL')
else:
    cflags.append('-mmacosx-version-min=10.15')
    cflags.append('-stdlib=libc++')

mainSources = Glob('src/main/*.cc')
testSources = Glob('src/test/*.cc')

env = Environment(
    LIBS=libs,
    FRAMEWORKS=['OpenGl'],
    CXXFLAGS=cflags,
    LINKFLAGS=lflags
)

spider = env.Program('spider', mainSources + ['src/main.cc'])
test = env.Program('test', mainSources + testSources + ['src/catch.cc'])

Default(spider)
